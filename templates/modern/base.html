<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="BLOOM LIMS - Laboratory Information Management System">
    <title>{% block title %}BLOOM LIMS{% endblock %}</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" 
          integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" 
          crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- BLOOM Modern CSS -->
    <link rel="stylesheet" href="/static/modern/css/bloom_modern.css">
    
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Accent stripe bar -->
    <div class="bloom-stripe-bar"></div>
    
    <!-- Header -->
    <header class="header">
        <a href="/" class="header-logo">
            <i class="fas fa-seedling"></i>
            BLOOM
        </a>
        
        <nav class="header-nav" aria-label="Main navigation">
            <a href="/" class="{% if request.url.path == '/' %}active{% endif %}">
                <i class="fas fa-home"></i> Dashboard
            </a>
            <a href="/assays" class="{% if '/assays' in request.url.path %}active{% endif %}">
                <i class="fas fa-flask"></i> Assays
            </a>
            <a href="/workflows" class="{% if '/workflows' in request.url.path %}active{% endif %}">
                <i class="fas fa-project-diagram"></i> Workflows
            </a>
            <a href="/equipment" class="{% if '/equipment' in request.url.path %}active{% endif %}">
                <i class="fas fa-microscope"></i> Equipment
            </a>
            <a href="/reagents" class="{% if '/reagents' in request.url.path %}active{% endif %}">
                <i class="fas fa-vial"></i> Reagents
            </a>
            <a href="/admin" class="{% if '/admin' in request.url.path %}active{% endif %}">
                <i class="fas fa-cog"></i> Admin
            </a>
        </nav>
        
        <button class="menu-toggle" aria-label="Toggle navigation" aria-expanded="false">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="header-actions">
            {% if user %}
            <span class="text-sm text-muted">{{ user.email }}</span>
            <a href="/legacy/" class="btn btn-outline btn-sm" title="Switch to Legacy UI">
                <i class="fas fa-history"></i> Legacy
            </a>
            <a href="/logout" class="btn btn-outline btn-sm">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
            {% else %}
            <a href="/login" class="btn btn-primary btn-sm">
                <i class="fas fa-sign-in-alt"></i> Login
            </a>
            {% endif %}
        </div>
    </header>
    
    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            {% block content %}{% endblock %}
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-left">
                <span>BLOOM LIMS</span>
                <span class="footer-version">{{ version if version else 'dev' }}</span>
            </div>
            <div class="footer-right">
                <a href="/legacy/" class="footer-link">Legacy UI</a>
                <a href="https://github.com/Daylily-Informatics/bloom" class="footer-link" target="_blank" rel="noopener">
                    <i class="fab fa-github"></i> GitHub
                </a>
            </div>
        </div>
    </footer>
    
    <!-- Toast Container (will be created by JS if needed) -->
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loading-overlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading...</div>
        </div>
    </div>
    
    <!-- BLOOM Modern JS -->
    <script src="/static/modern/js/bloom_modern.js"></script>

    <!-- Global configuration -->
    <script>
        window.BloomConfig = {
            apiBase: '/api/v1',
            user: {{ udat | tojson | safe if udat else 'null' }},
            version: '{{ version | default("dev") }}'
        };
    </script>
    
    {% block extra_js %}{% endblock %}
</body>
</html>

