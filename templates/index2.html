{% extends 'includes/base.html' %}
{% set page_title = 'rcrf-dewey' %}
{% set bloom_mod = 'index' %}

{% block extra_head %}
    {% include 'includes/oauth_script.html' %}
    {% include 'includes/accordion_styles.html' %}
{% endblock %}

{% block content %}
<div class="idx_section dewey-section">
    <a class="idx_button dewey-button main-button" href="/dewey">DEWEY</a>
    <div class="idx_subbuttons">
        <a class="idx_button" href="/dewey#register-files">Register Files</a>
        <a class="idx_button" href="/dewey#query-files">Query Files</a>
        <form style="display:inline;" action="/query_by_euids" method="post">
            <input type="hidden" name="file_euids" value="">
            <button class="idx_button" type="submit">All Files</button>
        </form>
        <a class="idx_button" href="/dewey#query-file-sets">Query File Sets</a>
        <a class="idx_button" href="/dewey?all_file_sets=1#query-file-sets">All File Sets</a>
    </div>
    <div id="dewey-stats" class="idx_stats"></div>
</div>
<hr>
<div class="idx_section navigate-section">
    <a class="idx_button navigate-button main-button" href="/serve_endpoint">Navigate Data Directories</a>
</div>
<hr>
<div class="idx_section admin-section">
    <a class="idx_button admin-button main-button" href="/admin">ADMIN</a>
    <a href="/lims" style="display:none"></a>
</div>
<script>
    fetch('/dewey_counts')
        .then(r => r.json())
        .then(d => {
            const el = document.getElementById('dewey-stats');
            if (el) {
                el.textContent = `Files: ${d.files} | File Sets: ${d.file_sets}`;
            }
        });
</script>
{% endblock %}

